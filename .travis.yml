language: ruby
cache: bundler
bundler_args: "--without production --retry 3"
rvm:
- 2.2
- 2.3
- 2.4
- 2.5
- ruby-head
env:
- DB=sqlite
- DB=mysql
before_install:
- cp config/database.yml.$DB config/database.yml
- gem update bundler
before_script:
- bundle exec rake db:drop RAILS_ENV=test
- bundle exec rake db:create RAILS_ENV=test
- bundle exec rake db:migrate RAILS_ENV=test
branches:
  only:
  - master
notifications:
  email: true
  slack:
    secure: lHuB2hivSh/c1N5v2YjZsRE45Cd0b7kFAftLHt9LL5wqyXZtkm3hwKG0D3G/OzT+oIgP+0kdicveVDjqoAAR5p70sj2flSpRW+fTFqGSsJh7S5OtMoeBB6Ix0YIM5QX3lT0upE0aCA1xOzUaX4vKR6TZO8hEzJBUotInLnFMXoI=
    on_success: change
    on_failure: always
    on_pull_requests: false
deploy:
  provider: rubygems
  api_key:
    secure: DWoVQrrNYVXZGkeyOxEBrxq7Y4BQSUIUArbVQmnZlbInkt+Ia99uzT9CjSyXF880cKQ/vDKIV25BthlwHv3FFgn32Si0feQ4mI5dk3zHBEkH7Z3CYAoITzuLq5pWR87Qkv4Tv4zTJ6KYo4HkbjwMUrupmTth1kQvON5EFje3jdo=
  gem: iqvoc_inflectionals
  on:
    tags: true
    repo: innoq/iqvoc_inflectionals
matrix:
  allow_failures:
    - rvm: ruby-head
